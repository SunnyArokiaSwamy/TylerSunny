function [Y,Xf,Af] = StackedPCAmyNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 09-May-2018 03:01:29.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 64xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 2xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-3.556831027635;-3.37487289907995;-5.46894270030705;-4.25556360959712;-4.23125735335743;-4.03778879216443;-2.98173752606686;-4.0699858751219;-3.47629570794285;-3.81010108136679;-5.59868093285602;-3.87106674876686;-3.83856439030483;-3.62382003002358;-3.814240384589;-3.58751733056665;-3.3469902689198;-3.75471033621594;-6.45808765581526;-3.57692125880059;-3.99284807266591;-3.24974339931118;-4.15263538728708;-3.92094603128831;-3.34683244942683;-3.91182736946411;-3.79785505771179;-3.32292961507735;-3.5238288586889;-5.40163622954315;-3.47060470965251;-3.97707562471938;-3.50168911643117;-4.18476281771394;-4.91485853230623;-3.44739809233266;-3.64063406471307;-3.66931530749484;-4.20330490337858;-3.51225188629596;-5.61695565682975;-4.40287077287806;-4.34016126627632;-4.79798758977898;-3.92712021383704;-6.20972055000752;-3.34907649406312;-4.31702040741568;-3.20773825340172;-3.46221527090971;-3.84493284243709;-4.48446227887747;-3.37510612777959;-3.93970332863101;-3.27703475777964;-3.0631808231819;-3.81981547810539;-3.48299603060467;-3.50259966494741;-3.72557360944439;-3.34739441959014;-3.28429652159618;-4.19083655542263;-3.49164720131593];
x1_step1.gain = [0.266636071952026;0.299435778092453;0.215348353550723;0.257761645428759;0.242021936251694;0.273543482521121;0.293094549615274;0.273873680798726;0.27680545650338;0.284268559717725;0.224704404488994;0.269569436759684;0.260572706488481;0.263678867556329;0.272033345632901;0.258137841494469;0.300307985383487;0.230248702125443;0.180657829535245;0.283378831774655;0.269966008760063;0.303298701238756;0.274294749188997;0.247215644694777;0.264459692682933;0.261763883612841;0.282543951174826;0.278061959856969;0.275112561759054;0.19808414263561;0.265006047762146;0.269537239905549;0.287825159988603;0.239707120259765;0.239109787793437;0.283219128199698;0.287765746503858;0.270036806673573;0.241028811441895;0.27099525894751;0.229849923044231;0.25143838564009;0.248250879424716;0.21521509898069;0.252558761548401;0.212249836236219;0.266385235420939;0.225253992183379;0.227236481973886;0.253698788075333;0.249652972923622;0.263827763899065;0.184427831746324;0.228944650026826;0.281707430119417;0.292561904446756;0.245765102219815;0.277230464348403;0.280446987859416;0.248637973915195;0.280249394873434;0.251791562808645;0.234415582883407;0.282937282444682];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.5152375901401742286;-1.3304216052704760376;1.1452974379652849368;-1.0344991580796982777;-0.7475185704418129129;0.94807159843148958167;0.49571960636356804386;-0.40464607477023972759;-0.20510357609962553971;-0.077636144924047786886;-0.039561032201151861976;0.48959478498220754261;0.34436427751876014236;-0.6495315268132590969;-0.78704819672825032661;-0.81778003842094093567;1.0409367688314321576;1.1215224419040179527;-1.2628510124232421585;1.4464346869998392364];
IW1_1 = [-0.10958820721639996043 -0.10759803367765458093 -0.27928901178499293545 0.12838573787633092427 -0.21003316159880491831 -0.0091509622056313716376 -0.072922168118023100725 -0.20230425179938882341 0.21230178115888506674 -0.075902034170958948556 -0.21185980769866993856 -0.092250329723349913658 -0.13148464376093982331 0.25099588119021759569 0.15563791535936785659 0.23944055299107849799 -0.073898373073884748852 0.10787440211269291868 0.24658780869505725342 0.054762872602250406429 -0.10709399522004567351 -0.055995348045699867845 -0.0076951307611451656709 0.078354110979876490095 -0.33735329115954526547 0.084800517397960961663 -0.2419190156970942307 0.25582531402830366307 0.19178676152341989081 0.31242965683518308939 -0.15736478960022165507 -0.12670958407406460178 -0.1456540683221914656 0.035043675431742110638 0.23668239359855150483 0.25265681150154400969 0.23801751958829905909 -0.31612014238953767276 0.30545879557076638378 -0.00065118263622788671342 -0.18373036495012753933 0.039140050059032809038 -0.2456362255478767298 0.16930536066300444498 0.031623408496950888846 0.23605009223619244363 0.17586466412686407867 0.0036794886316344303789 -0.0296341951113295414 0.041314298556399051132 0.067381616891439122252 -0.27831985316765789351 0.073366507367540509388 -0.18159512096000393622 0.053439617550349774455 -0.31580556710930890452 0.23897782646094467562 0.10675371806578078104 0.26829100654358556399 0.24744970483033218445 0.066162744813019661039 0.020201837908252435333 0.29290445189266428594 -0.012657737482571748688;0.13435006856189934954 0.026586064923306576557 -0.17547496524498823467 0.21687372372420318789 -0.20204367965892644499 -0.27657809958629614444 -0.010442391084243865876 0.096308929595270931223 -0.27823611192153585581 -0.23510357365387360429 -0.13110792325882364429 -0.13623887942779372429 0.18235582978706438295 0.25989727340064772143 -0.29477781046059547965 -0.12699391704354090482 -0.2566300217211518464 0.22848496519479816191 -0.22383035716575616636 0.28568836758528531883 -0.061055735658758561457 -0.32537306887566336266 -0.24846692845830400942 -0.16626196772040266469 0.10284485057828696153 -0.22255336257084631923 0.31250155512912408673 0.017454842130460803545 -0.090434899800527671077 -0.20950697694858280706 -0.054547968493234628984 0.17766532623391359524 0.15879616413398317532 0.17550782345660451145 -0.13258472537106133493 -0.29257271213657659592 0.23195089705042037931 0.1296133974831380764 -0.036611517195457840557 0.0093718286170620911102 0.14502827432853401812 0.17891683842993766351 -0.0407493840068399657 0.20357957036934634654 -0.19672192019095932625 -0.016405515475314491614 0.26698243993315801115 0.027970109393859347857 0.052834608848431219297 0.15218953951986985418 -0.27536650322105737931 -0.24819108899197139806 -0.085247504447745314771 0.032693088329378117152 -0.2165167560333430552 -0.10390791155115923494 0.26339524427452160049 -0.22356691483905002937 -0.28889541680086139319 -0.072257384179788455847 -0.0064069850270584757096 0.0046384208321732806751 0.21514586593551141003 -0.14600314462715707764;-0.21657911442079821884 -0.080416203703038244277 0.11695063108189955592 -0.16416078437427800152 0.2151819668320093526 -0.13871474882690368324 -0.31533698692296657784 -0.086123003122763830408 -0.068644204864787228271 0.33938793439638548222 -0.042489844892785635921 0.20891660885622495569 -0.052810500110540503638 -0.074906078189177688342 0.026274402820092496169 -0.00076135209142563970743 -0.030593698247597774648 0.32289609075052155829 -0.043958123517013836246 0.16884942719821652291 -0.19278869002230628049 0.03592102855099817138 -0.04496320596878602277 -0.31452864891764620303 -0.3628303676695459612 -0.2992795986755312776 -0.18425020129897717869 -0.16932796798823657181 0.066072561632696022449 0.16974554180955736538 0.12840000741340254486 0.14728962674085674389 -0.11980136370443125737 0.2158758580998824117 -0.13297485011396872889 0.35298185777882956637 0.070699194881325463924 0.22113952415948837094 -0.09682728568140240577 0.096607539853537607866 0.030341625679851057934 0.27102228767506530982 -0.078383021614994941029 -0.16261041138683984819 -0.15446351450934250882 -0.24936500339769321344 -0.080319101019441313527 -0.21289927235352248958 0.25622995814807697501 -0.27215592337571720138 -0.02059574225421908697 -0.26875635046237883463 -0.27745681059453508599 -0.21001594127756120778 0.16019116403877178834 -0.28446698454175645132 0.20108096023979432632 0.20823122535603175165 -0.039531342195906760129 -0.011193356819397976346 -0.14766283378404060356 0.053199829916496306492 -0.044543536014851059512 -0.1397504800895943422;0.31745327512997234543 0.2734003175361092719 -0.13043786484244526691 0.22630499943265489082 -0.29905423038484313381 0.09799715598786765125 -0.069968768728997529638 -0.32366231727238059523 -0.17524603693495530155 -0.042041222039505360408 0.016905803807532659294 0.01712384206234857098 0.070813924042640821743 0.093455529362220970957 0.25028782784008912765 0.19640958806385683255 0.02491703081110438131 0.12090641902196123947 0.097465238352187164028 -0.14119398286156639721 -0.22438760909365568219 -0.011267905327252417808 0.0060787637788897348756 -0.14789812785409825469 -0.25163567989407775727 0.094054380813519550264 0.055364200784432660019 0.20373953226800847749 -0.23719486154448032877 -0.22482816846639436248 0.035335297771934358335 -0.023505258927499671912 -0.14184683190895741589 -0.0047097259969513232541 0.17853598737071957325 0.062753360016438206048 -0.29698230848579720842 0.27112885255465390966 -0.17611077587961104784 -0.28706864537146631333 -0.099758588278243909286 0.18730466241211254919 0.063750233084345325762 -0.28906952518257633677 -0.019447380311820264276 0.13432029407708975799 0.31677206035128058215 0.18752558268870730962 -0.33473627618545254148 -0.027333924990095279095 0.12125770799762619623 -0.28772320229095527111 0.027148156969952867701 -0.092020929621701705314 -0.064423318599390794192 0.08536885845695148245 0.24522215703273697596 0.23075195275841239861 0.0015593631841127400528 0.14106980664088969446 -0.25022020344590023555 -0.11297088949908204447 0.2300109244458729274 0.32102119921268124081;0.11968922511202458037 0.12100281268239615473 0.13892343947989141406 -0.23180065029418595035 -0.058847317924003168799 0.17303424648294096766 0.28684062657543296648 0.015450357035812586903 0.0026820666905542703273 -0.27624106890797994751 -0.071281354294739376898 0.022448737976889066026 0.24127020549143027295 0.023413828990528288976 -0.09476851313438333646 0.089438027468602937509 0.27089413523619443325 0.26749237486963828303 -0.1145967565633105173 -0.010938839468645532652 0.17689133380001384466 -0.11451090693543186649 -0.023442519963929833726 0.24163388070037311595 -0.3114715310676570148 0.12786651811446378413 0.22989787181816645489 0.14573485597316679363 -0.24098928754202419977 -0.068941673454117738395 0.080525837741170572248 0.30777860403390872035 -0.25371864806805266568 -0.12531336697467965191 0.040569193311771480082 -0.12278572733786716209 -0.15876975612012214634 0.31942436265895773895 -0.060251582195444380874 -0.14422881454359331999 0.1497401065509438578 0.33864909681445404255 -0.34222746996675229569 -0.32084143186780811341 -0.10986223989045924843 0.29193498382714072603 -0.085680170327510130068 0.020007587905132462325 -0.18209793095842585764 -0.26230665954234716475 -0.26458000922574520519 0.33780743913458016747 -0.078212714772667737972 0.12341044579939912385 -0.054796254392380179532 -0.29798404694959046424 -0.25814812183591506756 -0.04082393247134261105 -0.17839533460196277392 0.095779622694959001827 -0.13306289494733844481 -0.050323607373354832528 -0.11153372124518179387 -0.19360365676170557259;-0.24977043403021495505 0.21710116706647025753 -0.25749038791646661206 -0.0029232275423918055446 -0.10573189776512192939 -0.14256022744793722667 0.16297886359091101616 -0.11622447295537703671 0.24273128028186638505 0.12409794893412844086 0.23630263583601918143 0.094263482777243640109 -0.099799640017129098712 0.23044572329301299396 -0.12315363728046382907 -0.25142877391899476347 0.040663121570219194767 -0.16418760167782731063 0.3420110825531565979 -0.19385325714155318688 -0.17049595332581080065 -0.24145349379200450879 0.0040342489639851736305 -0.24122468647974693035 -0.17208977435828859415 0.10731382314770526731 0.23639870247534788827 -0.36896949601316009204 -0.17344314224809737057 0.20230921126166837021 0.24112777434598464676 0.023367566882725319261 0.052204146166813590602 -0.22816744070176958603 -0.056579612199145562501 0.0095367459129204260049 0.27530283018246859417 -0.23212532277897429678 -0.17804823572550607103 0.10414811897951495312 -0.19149059526644446327 -0.14049011333170177696 0.024446351620943412852 0.060411246439591254065 -0.16722323985748233088 -0.12260397439611182835 -0.23464975839819512959 0.064761350428674618884 0.27832868544861877336 0.090700134545305732825 -0.21161826087877036451 -0.051135349808110810987 -0.04127647309010747112 -0.13348308756909282868 0.085812226658591256312 0.078648325318709674803 0.11539318504076323535 -0.1663875386278922397 0.089942378949608423055 -0.091301152975234584064 -0.23808575270253401479 -0.064475790762922743915 -0.07917187291315780362 0.018530856197365611765;-0.02867940612100716713 -0.2710890808625271986 0.10034183037149159434 -0.20839628179825409049 0.1209858802775917036 0.021286269433791981526 0.13895653797973875343 0.083689641763817865239 -0.15770512734078562245 0.022130577268054011514 0.27000444168068182815 -0.23775196179137450536 -0.12615101639931389221 -0.19090004888736225586 0.1733250283672239378 0.1653365531512077935 -0.095979790227947711645 0.27272710959353235749 0.11261046086125119092 0.19910703284369934973 -0.00438795619155384585 0.15408873956418261963 0.12540659500640069512 -0.12737463449770994317 -0.10222321280626947559 -0.16608636448182231837 -0.037859769992171277142 0.30394972659809438298 0.15670989854545142039 -0.041745616244107920656 -0.11521788837485738566 0.32090871674425319737 0.094907802382599479318 0.23066349485990586543 0.10607836059970660036 -0.10221654875327418344 -0.092207957949324681479 -0.0034703971059710063407 0.024973091002578190478 -0.14728692153016478827 -0.33520940100351914737 0.23326124223644562061 0.32316185567473354467 0.012993836391357788118 0.012179172151237305927 0.21290041191989275693 -0.10336919302934528819 -0.0586075122334540205 0.22199036639875011079 0.090228899491685582435 -0.114401795271263651 0.21984870681619228527 0.2435549207399467786 -0.23855285539633291902 -0.027715104712527784125 0.01164708611392782471 -0.14697225514250017442 0.064422882883854198921 0.17750145545921733325 -0.037401898743412341497 -0.13134733285452654394 0.30357145059186890768 0.18174753042450092488 -0.18232619563830065879;0.08479044903568837277 -0.14321302465454438524 -0.07694055837726432312 -0.21946566092382346902 -0.24746201281520480153 0.19798012873555467794 0.16247030821916735865 0.24648691215366907992 0.059154025371989514548 -0.10387237012552952287 0.14029232689353313135 0.23182281204474225467 0.024846214313308131322 -0.30094286940861975088 -0.014610365449762321294 -0.21862710219862543926 0.24378052664005769867 0.25953007269296862747 -0.18445974179528507042 -0.228973851586849797 -0.12979287974403902473 -0.2872531641720686979 0.0043204313939361558422 -0.23089994856531917411 -0.085935749389496163264 0.159625892099148875 0.15629592881745904553 0.19069219491592176441 -0.13060626333248118169 -0.2514062342773832337 0.15228954573689384988 -0.0082497662327386412501 0.20869064500362022319 0.28317882976438812914 -0.21679108999358831511 -0.20515660201456650813 0.089126091011618377435 0.19294403147886365901 -0.032593525571450177036 0.1604189534839425002 0.054934798500673710786 -0.28618105849448982614 -0.23212172704916356203 0.2576979901761216607 -0.15642309490042666242 -0.18183746506064474291 0.034872752258074221632 0.1334252592864387521 -0.037791945224403156178 0.25122273259105643017 -0.19354293100527059091 0.071146986322108196621 -0.21368569269253995246 -0.055752371671415730525 -0.29006392047696694103 -0.11495098345953949637 0.08157004073338230965 -0.12811509646407145957 -0.19809691081225552778 -0.12356225108241922217 -0.23910691394863439752 -0.27259464954912232537 -0.24818810841895716512 0.041778256691724476035;0.25941491211517175852 0.16480657094038936306 -0.27766443074235952482 0.087963438146647768279 0.18303562416617072395 0.05641340329033914941 0.15441102591696576063 -0.28750188993288916528 -0.28904553940285160341 0.1548059876340769081 -0.052328967187756703083 0.26749668244158553154 -0.030048321680247246784 0.22928087977658662133 -0.20063775127880481564 0.26859090094799215054 0.26163229006802113386 -0.12467724587182853202 0.037222732374423417312 0.14637241396361680423 -0.01484892870296884021 -0.10323016625200502616 0.0043254860978724366319 -0.20550361223071872407 -0.16340481977920759404 0.23324874836244238741 0.25580600923409818614 -0.11430051292261787788 -0.063952824241757785795 0.029504404392901199122 -0.21060163978530260787 0.0046559670303588235329 -0.14937912563550156952 0.27580842654650333801 0.26734224321923116818 0.098448672242979151648 0.17957505337225426745 0.08551075686224041128 -0.15333514162319941687 -0.14183958068020152687 0.10429045619066869277 -0.1507294950495882413 0.13818233908727770021 -0.057451545405770451658 -0.29350339380781226284 0.21705030228575980522 0.085353720199825150461 -0.26008428851592846343 0.19223106836489811666 0.10024556398973648308 -0.11150933120468589643 0.24088594828037870887 -0.046112995942853278464 -0.026425245914648114176 -0.26598647677041692416 0.0079780822930767946594 0.23603061535707531293 -0.13885922562738500785 -0.20181007684531521162 -0.26762719411149454851 0.20219983326931276202 -0.062991621089296331859 0.27752900861548424061 0.30523672337481960737;0.01762248820934570262 -0.16882815070988252404 -0.056252856627054419192 -0.10968827409045103782 0.16788810648601434905 0.02199898106064063219 0.20408784046010264301 0.08817118318347505479 -0.20524271812115998936 0.20019491247736387329 0.062022299172164563341 -0.23972380479081284443 -0.24426238069796435415 -0.15737740749246703631 -0.16098288865111587409 0.2303249765902920243 0.02518916294443711637 -0.25385200876509650403 0.22558836707010818112 0.18459847901605547227 0.2527186586449527983 0.16796027888596959388 -0.24524685230831760885 -0.26092523187352228975 -0.06654915674467336284 -0.027145550335308497175 0.2384671884412031817 0.10109848255872180833 0.089137026696018570315 -0.13397547834397763311 -0.26296446216661312212 0.15983229625324368861 -0.19196616479334172034 0.081886825509387833888 -0.16568397042352769888 0.11012022362021718636 -0.15034810190743835845 0.26979230145350757697 -0.21735929828195657554 -0.27427834258136729595 0.047714983178173374367 -0.29282666056306677627 0.28034536837100831885 -0.20516255311268219441 0.094651049726889702196 0.21365752457191292124 0.024320040546027741485 0.056264011461915015844 0.25423092990453655116 0.11275374426438480868 0.17951200038064291098 -0.079883629254015708909 -0.26262888778281823221 0.19433356390706588157 0.054551953376077232105 0.12348873948181640636 -0.075519450345783348255 -0.17981014366449046826 -0.26197025848196481279 -0.032168641308082189523 0.28040357731393233953 0.17292060796328315164 -0.29699163721125521054 -0.21896873129746496911;0.10372591862072817748 -0.3224381284768661482 0.10817338372678581004 0.28032002053639948347 0.0049356542235646626987 -0.10977390036902830162 0.19699083681459084172 0.047277187259140582287 0.2258482582619315282 -0.16232447926133747318 0.077200651371290368585 0.24549251194365165341 0.14622136999865770202 -0.15363698764419306264 0.05575320493390627935 0.038120187752297217398 0.19231617150838523078 0.18414534329059184525 0.023015087256116898567 0.20083868036088697862 -0.22325110465499625745 0.28104182240528896575 -0.21229486159476274043 0.11563582732521857088 -0.0054961634695082431379 -0.22780405339030851408 -0.20617935868322539994 -0.11388958760911467583 0.18116899418520032716 -0.22138680125880239036 -0.10960408833119347771 -0.08442749773217479714 -0.011166436061570091109 -0.29355512257739890813 -0.32566356639867044542 0.21085743506352078169 0.013830574513864532515 0.29052463924304178233 -0.028662699361307622525 -0.14892338614615566184 0.2412050284829165836 0.083896039899338761825 0.087574266082946911061 0.061726864378016957358 -0.20649735882339614879 -0.033054069240002606489 -0.13142756078428868838 0.23944651226009819323 0.10661806446948171589 0.23694758534043114384 -0.1207247560638482764 -0.24158805991181964146 -0.056449639574711329981 -0.080644553613998692931 -0.012590746312139010701 0.22049613011282478969 0.1701929370494517646 -0.35296679920757073612 0.064097062495119344616 -0.18841045103930931237 -0.18185947817479553024 0.060539784923175334053 -0.14848716942097128779 0.31366970115418368881;0.099783471316463437373 -0.034147402965532376584 0.34982186800601466903 0.046912373695722223155 -0.13189391355723334431 -0.063579732849218140167 0.28075098701921630262 -0.041066492415418667794 -0.19853015349160360592 0.018475539629429164196 -0.182446899279512742 0.22881523049165747308 -0.26115167392823646075 0.067831889653515067828 0.099560840378323883781 0.064457898440426153464 -0.17609553016687148896 -0.28863189231286590086 0.2012077679252478879 -0.13674591035024738495 -0.2704201768811833051 0.14055846934581361918 0.045305238197836703029 -0.24132283757758279941 -0.0020976695339067069623 -0.26268926187201907529 0.069768564384786901922 0.2519966426318148156 0.21672010999943103204 0.093142016402751756643 0.18627936865009703249 0.0056937020569547205917 -0.056898427589319316988 -0.24336933583582490148 -0.1915083723770292512 -0.13742509805803013179 -0.15505650309123480968 0.33784787339729521749 -0.033406030382302567827 0.074896713631528916144 0.1491006253378083235 0.30163835241588765612 0.12339450918110897448 0.2289672162435812397 0.15673854651738447497 0.074820538245610607175 -0.20815317645628361731 -0.027755514859762787233 -0.071816899028548417117 -0.025261545059237586891 0.14076738668507127183 -0.090960833245790212453 0.073264308419934018324 0.14146310975052833747 0.22409357054396839004 -0.15667823831644406285 -0.19306706786389618569 0.13375390885897586735 -0.23523010532035315556 -0.14113373389029160165 0.13176149546470961038 -0.13043085418120478614 -0.29473699627417404567 -0.25154038075832546584;0.27579149839677752354 0.27781180621119733187 0.2955737376579991027 0.14427950410893325417 -0.27463496251131014336 0.1892594001777760937 -0.24209289302606099015 0.1971203845674739108 0.20907588091477175007 -0.041213010330247101809 -0.01301535590859030124 -0.30759784482028429409 -0.051511564718149563391 -0.12006020215143864416 -0.14545821953074003496 0.30848688640887378387 0.17920431288224375477 0.15124959555666658839 0.2444040234963185676 0.061470234234339421464 0.25426593763042515395 0.16268960390653094961 0.074323788258735118406 0.068688607962813272301 0.19276881217281519043 0.16652612907840197431 0.17623670934190735493 -0.13006449863355507013 -0.090682652598492563545 -0.0042343059093527301087 -0.073082175297145529624 -0.24094486550483931731 0.18821971050016064742 -0.20761157988260706131 0.16228219890470821363 -0.15483562697615019244 -0.32134289461386528197 -0.27471362189277259702 -0.10577193893891131959 0.2932495549939572177 0.0066299382552073146332 0.034137805595727238606 -0.12197638717965675337 0.11040885221303618768 -0.051768944905495981046 0.23320884053064683261 -0.22123361131208524322 0.097304161099072833396 -0.056444589833467097295 -0.028336627624133726988 0.035502133557279311193 0.01263834355396940487 -0.24485603708668057799 0.05344020930819697035 -0.24701197960023132949 -0.11714878946285858796 0.010632445710780247944 -0.074528449807635663293 -0.14544029162897198493 0.28021032530725398235 -0.29429189871627881026 0.25405970400551636246 -0.036273868723737223707 -0.19782876745639726979;-0.21114887926244607641 -0.16443880866938942464 0.2811952481472160259 -0.33994758916180828345 0.075728603913365596934 -0.089310586158597771167 -0.056955063629954484627 -0.19863371659446768525 -0.1128257330306935563 -0.22313418360686820829 -0.15239217535283000604 0.031267779208633841859 -0.31650065119209919162 0.22752138080722417168 0.047188882021669306677 -0.22047532585814427764 -0.16766886829590449404 -0.026498661498638737682 0.2054246605550971716 -0.0070152592336605711781 0.096637494449773042593 0.11222740045384427265 0.1118899444694947537 -0.22654395713264799395 -0.10652452927284783435 -0.24591752384909959517 -0.20993952671066545834 -0.18632513533579606047 -0.23609901148016104733 -0.18792473743119486596 0.31745689132582344261 0.15763799844040324305 -0.22479264849785005054 -0.31565719334691411113 0.17941066743334824207 -0.082887797333253493415 0.15839967965285686735 -0.039774629498828609209 0.13997733574785195532 0.1181838206680489306 -0.17862258605755171326 -0.25392159517071949404 -0.018121906035756314701 -0.058771233826280931678 -0.10664838854134682522 -0.31602281685121924593 -0.24901723963446656396 -0.12242132651240390795 -0.032478240838271187074 0.19651888320439303559 0.053425741062751871957 -0.21231833308758929491 0.13887027829844722504 -0.25246112063863551667 -0.04746351756400055133 -0.087527925086472307958 0.082789473612748215592 0.11995254038405206432 0.27918765527355998701 0.03859680832300969866 0.080193682254288731204 -0.26813420284026545648 0.19002908624108102997 0.10195702976326946609;-0.051529841799396958191 0.045002043470806211978 0.23899206779828363612 0.05177696819444217724 -0.33816197815004062077 -0.027303832181123005585 -0.0067379601980472290934 -0.37054259284841428723 0.11219771476113817033 0.07017309265944550456 0.035538679561893354863 0.11285366219176469482 0.30466385299345305482 0.26311527840907156239 0.11843222816353235483 0.18733014119132654351 -0.24738462689989151877 0.10168625978397573262 -0.26876276221904010777 -0.27298737168230069461 -0.013303401005611840274 0.087076850880273934385 0.30509923718464565523 0.10807441374999755823 0.26258016230795688806 -0.0096309866229979529395 0.1450170886304531781 0.19976556674433840199 0.059891038705478696902 -0.25178357968240605569 0.057509929437711895805 0.021001858817616448488 -0.28643570570467608016 0.13814219064067026488 0.13483605828323033671 -0.10511511190270890481 -0.32751284349463721801 -0.13915989689793281658 -0.026721614540462866605 0.14918499754683589575 -0.32553549833986966666 -0.028805118504573293953 -0.29680967650391237855 -0.15048977868063576069 0.18494044570484760581 -0.022747846191291238443 0.11797263647952094257 0.066256286446929990586 0.11463369894015286443 0.23503390615627042792 0.16145664217793598283 -0.186997363252902421 -0.11922213401724227055 -0.12618275767654235642 0.051293918077881084372 0.11683553659131019897 0.13575245052097409393 -0.04554702810476392999 0.15360916166600388499 0.32104000746626559781 0.12389003495635239616 -0.12731001112956491506 0.27978228345664779564 -0.24935012679048557116;-0.12846490391509332585 -0.093824788614571649759 0.24964779545383769532 0.063225545351769885105 -0.28144506217488352018 -0.091515858882937950458 -0.16132972555291300032 -0.25001701430647310653 -0.28661181482452230407 0.28529311094327841625 0.29374012171535229809 -0.079554894299706885308 0.02632512698237365889 0.28714083758853414796 -0.13265326898472939998 0.20464611425534848244 0.23021808139865973519 -0.22188214166841246922 -0.19764451334882743305 0.21080432883984337455 0.024361458181787594424 0.11566208807313436979 0.29130590825580210401 0.007285108254082550347 0.14404623737302185704 0.0036939242676100256246 -0.01105210902493476352 -0.021931712708948319229 -0.31739815965097645245 -0.20131364409953728112 -0.10328359505495544879 0.10417488230532179205 0.069274549069611696117 -0.22449387897272171655 0.18568270688892590803 0.27074504494856066472 -0.060495552124487324275 -0.23575675310104080018 -0.048277246777308421843 0.042092804829446522907 0.15894054263979837116 0.055551872795682057105 -0.077842978613964206036 0.21888444137852514082 0.15593696113339022835 0.091148980094193976509 -0.018259763984736381015 -0.14536212906890638719 -0.019247048612746300855 -0.20126401201693175369 0.17536077540016900556 -0.29755578189102060982 0.058706527962508754659 0.038059749082314270341 -0.26166921097327222601 0.2319543110449612533 -0.11815661367619753608 -0.057074566070605368961 -0.15362317308495038182 -0.27748924861475848802 -0.30400372391917157566 0.25345258512562662823 0.022800870325332098926 -0.27516534843250006759;0.10379837223876957342 -0.27168154677125100349 0.1897567301031453102 0.18530944602180579595 -0.20370544169480434005 0.10721944333180492837 -0.26989274520774020338 0.19646563402846639601 0.13772432237837675673 -0.2260285194052087665 -0.035395609754610452002 0.079687703355075176215 0.25025206752601730775 -0.06818851727713474975 -0.027013807818738438948 0.15263788743035111573 -0.064134171349776308846 0.012314538338308252813 -0.19532952946636442104 0.094988181640709504205 -0.22196627967548146487 0.26647826625907455877 -0.22007761508686563001 -0.11618500607865260565 0.17045853110948139264 0.23607831103602605616 0.055150069790650749213 0.074388170945218101693 -0.11823760227568384795 -0.21503216141354175583 0.24672537023273968804 0.18934780728057123977 -0.28787731047548731356 0.085436240424031181795 0.27434171065851103988 0.13096765210728095186 -0.13132544579607025037 -0.21621824097062231074 0.16139530999459320015 0.029000161670408822201 -0.18978806215069221608 -0.17370695438247601983 -0.075888986303937991384 0.24285332633714284967 -0.2005521642801894322 0.14549776546939649502 -0.22607270075457411296 0.17425859884033126357 0.26085299199230110867 -0.2705059408616092842 0.22851214208825576524 0.074714393988951161019 -0.20498506515589839938 -0.028951537491140058589 0.22556461586466006186 0.14676811542102533026 -0.12797196351307249529 -0.23539381644265128246 0.11469445431049488104 0.27281989888256097387 -0.28808876169732916539 0.094419615710997245595 0.177809638214255189 0.087938252542181100102;0.26226210705617680752 0.01135447353815031632 0.0048784725731605086546 0.061295578554210944366 -0.047964861547751744264 0.074734368906596987392 0.27162844298547639266 0.062574732852946374217 -0.021074928381530366045 0.23644529086445073562 -0.26925112798736650088 0.1895758344948525187 -0.084140203838803870329 0.20378188358519694345 -0.12880868401533385192 -0.17646621809707460637 -0.27867322007271400075 0.071585539841791737126 -0.28338227922685338411 -0.097142094719784244372 0.28863827439247119466 -0.0028565176037445259849 0.25435987636007167945 0.18736171784790092709 -0.12370059982010171706 -0.10364659164661359225 -0.16062676289674734931 0.30772851912899928939 0.051361663730623098589 -0.088707607824245235384 0.22853220542109053959 -0.17141165376328798553 -0.16545968194971191756 0.17686871536549891859 -0.055032350182475125999 -0.10925888119868551462 -0.21593977105214934298 0.16849589230568334797 0.20270001058227390955 0.20576111051333736968 -0.14159902986175243456 -0.12163388095804920919 -0.12700630415060143452 -0.061545226174341383096 -0.20695701541273042734 -0.19454434965367589649 0.1048635762189962517 0.17827906441299851137 -0.14599520766193721522 -0.27485651808374195193 -0.21090446188614239698 0.22982799427097810874 -0.043138601294987047319 -0.13717975351415309659 0.087290737694431741467 0.22104869053053169403 0.24355579526117163147 -0.25075255507191185345 -0.25820433860630059852 -0.21547749521911413462 -0.23333898101931499491 0.1207993918327693178 0.027245336962337187575 -0.30138609242653202624;-0.011261443808323471846 0.19388436143278470203 -0.03974581228684501838 0.23176398516246385362 0.10492409423157601778 0.090165251209617255923 0.13086046888707225655 0.19703163437950360626 0.2511831739184780532 0.03187106369480359469 0.26454560954700223618 0.033348070573757042367 0.23330493995146270314 -0.2080300577729925493 0.18278498152205738259 -0.051591171345795536207 -0.25907693099266859704 -0.29597427049527630372 -0.28472191682036535054 0.26971116805894440605 -0.071024301372441006608 -0.034781096871000879989 -0.17729796624825305829 0.19994984744529811782 -0.27314108230980083114 -0.24847942084533714002 -0.24977887911040283497 -0.11692628891833518889 0.062003554657587556243 0.25930989234619267192 0.20411034522138260527 0.21502210571903054848 0.1126313402734085839 0.044498429519910953633 0.18945907998271047101 0.056913575444650407742 0.1013126340578161394 0.019926580563899266851 0.13940796070454822275 -0.063084134999391638932 -0.13058736667589113112 0.14749475977055936937 0.18309279599766467572 -0.26805225774086266499 -0.19796907335863653254 -0.26496136890897881155 -0.19150377498298024048 0.26710898698294727183 -0.093689012016299047514 -0.20998885065208625078 0.16693260176628177405 0.22853314977671446151 -0.30316625118363582647 -0.16491788539747206932 0.23004234280763810605 0.21575867898519254795 0.069147498976940932613 0.046530487202646630962 0.096760010948222591187 -0.12644597103190602372 0.22454666026294697878 -0.015900318720989816551 0.14573251861301811383 0.28913656708934742934;0.20322645288575036382 -0.15478800114665783316 -0.24337515053217018135 0.24479498869287297236 0.22022715708920648225 -0.0055904733278118543677 -0.21974696676045424315 0.072582519771118306218 -0.13254178871449612265 -0.04812016856075536364 0.26896335939828247552 0.09554478761102466744 -0.15344578001223999064 0.079485277832044412549 -0.24730310275216951799 -0.3110723073280015627 0.28090619123220977871 -0.016189559579889840207 0.058352336889089043148 -0.19928417703225784208 0.074062454232449795311 0.09780714509411775337 0.28593533807562104831 0.27728779417643278915 0.076862219327040723349 0.10267656059985358352 -0.13145213199180158514 -0.26578520377667730346 -0.1150724335866049608 0.02595309143270971633 -0.16072930704133830959 0.25136800430522843186 0.010705611959909846348 -0.082608408498230700978 -0.058380062521107306539 0.17633212082351681915 0.26101219252601021159 0.28102415976504230288 0.19667146902515916795 -0.031272115486175366961 0.028909823761964721645 0.025766330491783992485 -0.018215064017962530329 -0.20138986873625552843 0.084810993346039947882 -0.23566098572507263031 0.19079085881697507854 -0.035338683880940462145 0.24860486491278607768 -0.21660326071881122467 -0.19209171884284187426 -0.32582502190357298666 -0.16958823449147150675 0.18557500265552559493 0.088599158828272725485 -0.2015836199400834472 -0.26865760584307862846 -0.074392582246156371828 0.21625002702696827228 0.19626484429106352825 -0.14494981593432648692 -0.22820583860320795 -0.31273831335332497039 0.02151241817673715459];

% Layer 2
b2 = [0.10358822952148405427;0.85520157188518641789];
LW2_1 = [-0.38054806729484419447 1.0544801545658866182 0.22161272125954156742 0.66768119854378171762 -0.15832656772830580594 -0.52525289888516990544 0.69452159340945551769 0.47469242193435962074 -0.13691767639486646102 0.96009456767612422201 0.32951582905906939835 -0.80769630102839040653 0.033536854136400978676 0.77076413756618100681 0.3292067222095208523 -0.67095087105724904308 -0.62099701644537119716 0.51904440154247810657 -0.55722215370498295872 0.049438286687974695999;0.54168767299518982838 -0.39510270806438146929 0.36834701343949088903 0.06650263709052425809 0.61198458221578400096 0.57063984910584952814 -0.13813794009085286763 0.27535366242021164229 -0.03687145269387186175 0.84451483513902669831 -0.094309196439104278631 0.053728930560523496807 -0.193746335810408149 0.23869777042746243012 -0.48969280695650974078 -0.59227728637250975918 -0.21772860463073456794 -0.50133491969149679424 -0.10973055445025119148 -0.52004234957028350195];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
